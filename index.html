<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Web Theremin Prototype</title>
  <style>
    body {
      font-family: sans-serif;
      text-align: center;
      margin-top: 100px;
    }
    button {
      font-size: 24px;
      padding: 15px 30px;
      margin: 20px;
    }
    #freqDisplay {
      font-size: 32px;
      margin-top: 30px;
      color: #333;
    }
  </style>
</head>
<body>
  <h1>üé∂ –ú–∏–Ω–∏-–¢–µ—Ä–º–µ–Ω–≤–æ–∫—Å</h1>
  <p>–ù–∞–∫–ª–æ–Ω—è–π —Ç–µ–ª–µ—Ñ–æ–Ω –≤–ø–µ—Ä—ë–¥/–Ω–∞–∑–∞–¥ ‚Äî –º–µ–Ω—è–µ—Ç—Å—è –≤—ã—Å–æ—Ç–∞ –∑–≤—É–∫–∞</p>
  <button onclick="startTheremin()">‚ñ∂Ô∏è –í–∫–ª—é—á–∏—Ç—å</button>
  <button onclick="stopTheremin()">‚èπÔ∏è –í—ã–∫–ª—é—á–∏—Ç—å</button>

  <div id="freqDisplay">–ß–∞—Å—Ç–æ—Ç–∞: 440 –ì—Ü</div>

  <script>
    let audioCtx, oscillator;
    const freqDisplay = document.getElementById('freqDisplay');

    function startTheremin() {
      if (!audioCtx) {
        audioCtx = new (window.AudioContext || window.webkitAudioContext)();
      }

      oscillator = audioCtx.createOscillator();
      oscillator.type = 'sine';
      oscillator.frequency.setValueAtTime(440, audioCtx.currentTime); // —Å—Ç–∞—Ä—Ç–æ–≤–∞—è —á–∞—Å—Ç–æ—Ç–∞

      oscillator.connect(audioCtx.destination);
      oscillator.start();

      window.addEventListener('deviceorientation', handleOrientation);
    }

    function stopTheremin() {
      if (oscillator) {
        oscillator.stop();
        oscillator.disconnect();
        oscillator = null;
      }
      freqDisplay.textContent = "–ß–∞—Å—Ç–æ—Ç–∞: ‚Äî";
      window.removeEventListener('deviceorientation', handleOrientation);
    }

    function handleOrientation(event) {
      const beta = event.beta; // –Ω–∞–∫–ª–æ–Ω –≤–ø–µ—Ä—ë–¥/–Ω–∞–∑–∞–¥
      if (!oscillator) return;

      // –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º beta (-180..180) –≤ —á–∞—Å—Ç–æ—Ç—É (100‚Äì1200 –ì—Ü)
      let freq = 440 + (beta || 0) * 10;
      freq = Math.max(100, Math.min(1200, freq));

      oscillator.frequency.setValueAtTime(freq, audioCtx.currentTime);
      freqDisplay.textContent = `–ß–∞—Å—Ç–æ—Ç–∞: ${freq.toFixed(1)} –ì—Ü`;
    }
  </script>
</body>
</html>
